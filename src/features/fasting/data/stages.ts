import {
  Utensils,
  Activity,
  Battery,
  Flame,
  Zap,
  Leaf,
  Trophy,
  Shield,
  Moon,
} from 'lucide-react';
import type { LucideIcon } from 'lucide-react';

export interface FastingStage {
  id: number;
  hoursStart: number;
  hoursEnd: number | null;
  title: string;
  subtitle: string;
  icon: LucideIcon;
  details: {
    physiology: string;
    sensations: string[];
  };
  recommendations: string[];
  precautions: string[];
  color: string;
}

const getPhaseClassParts = (phase: FastingStage) => phase.color.split(' ').filter(Boolean);

export const getPhaseTextClasses = (phase: FastingStage) => {
  const parts = getPhaseClassParts(phase);
  const light = parts.find((c) => c.startsWith('text-')) || 'text-slate-600';
  const dark = parts.find((c) => c.startsWith('dark:text-'));
  return dark ? `${light} ${dark}` : light;
};

export const getPhaseBgClasses = (phase: FastingStage) => {
  const parts = getPhaseClassParts(phase);
  const light = parts.find((c) => c.startsWith('bg-')) || 'bg-slate-100';
  const dark = parts.find((c) => c.startsWith('dark:bg-'));
  return dark ? `${light} ${dark}` : light;
};

export const getPhaseSoftBgClasses = (phase: FastingStage) => {
  const parts = getPhaseClassParts(phase);
  const light = parts.find((c) => c.startsWith('bg-')) || 'bg-slate-100';
  const softLight = light
    .replace('-100', '-50')
    .replace('-200', '-50')
    .replace('-300', '-100');
  const dark = parts.find((c) => c.startsWith('dark:bg-'));
  return dark ? `${softLight} ${dark}` : softLight;
};

export const getPhaseAccentTextClasses = (phase: FastingStage) => {
  const parts = getPhaseClassParts(phase);
  const light = parts.find((c) => c.startsWith('text-')) || 'text-slate-600';
  const dark = parts.find((c) => c.startsWith('dark:text-'));
  const accent = light.replace(/-600\b/, '-500').replace(/-700\b/, '-600');
  return dark ? `${accent} ${dark}` : accent;
};

export const FASTING_PHASES: FastingStage[] = [
  {
    id: 1,
    hoursStart: 0,
    hoursEnd: 4,
    title: 'Пищевая фаза',
    subtitle: 'Пищеварение и насыщение',
    icon: Utensils,
    color: 'bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-300',
    details: {
      physiology:
        'В первые часы после приема пищи организм получает энергию преимущественно из недавно поступивших нутриентов. Инсулин еще повышен, активны процессы усвоения и распределения глюкозы, а переход к внутренним запасам выражен слабо.',
      sensations: [
        'Чувство сытости и относительно стабильная энергия.',
        'Иногда сонливость после последнего приема пищи.',
        'Голод обычно минимален или отсутствует.',
      ],
    },
    recommendations: [
      'Поддерживайте питьевой режим: вода небольшими порциями в течение дня.',
      'Избегайте тяжелой физической нагрузки сразу после старта.',
      'Сохраняйте спокойный ритм, без перегруза задачами.',
    ],
    precautions: [
      'При выраженной боли в животе, тошноте или рвоте лучше прекратить практику и оценить состояние.',
      'Если есть хронические заболевания ЖКТ, старт нужно согласовывать с врачом.',
    ],
  },
  {
    id: 2,
    hoursStart: 4,
    hoursEnd: 12,
    title: 'Постабсорбтивный переход',
    subtitle: 'Снижение инсулина',
    icon: Activity,
    color: 'bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-300',
    details: {
      physiology:
        'Пищеварение завершается, инсулин постепенно снижается, а организм начинает мягкий переход к использованию внутренних источников энергии. Колебания аппетита в этот период чаще всего связаны с привычками, а не с реальным энергетическим дефицитом.',
      sensations: [
        'Появляются первые волны голода в привычные часы еды.',
        'Энергия может слегка снижаться к концу интервала.',
        'Возможна раздражительность при высоком уровне стресса.',
      ],
    },
    recommendations: [
      'Пейте воду регулярно, не дожидаясь сильной жажды.',
      'Поддерживайте легкую активность: ходьба, бытовые дела, мягкая мобилизация.',
      'Снижайте информационный стресс и избегайте эмоциональных перегрузок.',
    ],
    precautions: [
      'При выраженном головокружении или предобморочном состоянии голодание лучше остановить.',
      'Людям с нарушением углеводного обмена нужен более частый контроль самочувствия.',
    ],
  },
  {
    id: 3,
    hoursStart: 12,
    hoursEnd: 18,
    title: 'Расход гликогена',
    subtitle: 'Переход на внутренние запасы',
    icon: Battery,
    color: 'bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-300',
    details: {
      physiology:
        'На этом этапе печень активнее расходует запасы гликогена для поддержания уровня глюкозы. Организм приближается к более выраженному использованию жиров, но переход еще не завершен.',
      sensations: [
        'Голод может быть заметным, но чаще волнообразным.',
        'Возможна легкая слабость или ощущение "пустоты" в теле.',
        'Часть людей отмечает падение концентрации ближе к 16-18 часу.',
      ],
    },
    recommendations: [
      'Сохраняйте ровный темп дня без силовых пиков.',
      'Делайте короткие прогулки и дыхательные паузы.',
      'Поддерживайте сон и ранний вечерний отдых.',
    ],
    precautions: [
      'Если слабость быстро нарастает, лучше завершить протокол мягким выходом.',
      'При терапии, влияющей на сахар или давление, не продолжайте без контроля врача.',
    ],
  },
  {
    id: 4,
    hoursStart: 18,
    hoursEnd: 24,
    title: 'Метаболическое переключение',
    subtitle: 'Граница первого дня',
    icon: Flame,
    color: 'bg-rose-100 text-rose-600 dark:bg-rose-900/30 dark:text-rose-300',
    details: {
      physiology:
        'Запасы гликогена близки к истощению, усиливается роль липолиза и начинается более заметный переход к кетоновому метаболизму. Организм адаптируется к новому режиму энергоснабжения.',
      sensations: [
        'Голод может ослабевать после нескольких волн.',
        'Часто ощущаются холодные конечности и снижение выносливости.',
        'У некоторых появляется ментальная ясность на фоне снижения физической энергии.',
      ],
    },
    recommendations: [
      'Пейте воду, при необходимости добавляйте немного соли по переносимости.',
      'Избегайте интенсивных тренировок и длинных стрессовых совещаний.',
      'Выделяйте время на восстановление и сон.',
    ],
    precautions: [
      'Тахикардия, выраженная дрожь или предобморочное состояние - повод прекратить голодание.',
      'При боли в груди или одышке нужна срочная медицинская помощь.',
    ],
  },
  {
    id: 5,
    hoursStart: 24,
    hoursEnd: 36,
    title: 'Старт кетозной адаптации',
    subtitle: 'Начало использования кетонов',
    icon: Zap,
    color: 'bg-violet-100 text-violet-600 dark:bg-violet-900/30 dark:text-violet-300',
    details: {
      physiology:
        'После первых суток организм заметнее опирается на жирные кислоты и кетоновые тела. Глюкозный путь сохраняется, но перестает быть доминирующим для большинства тканей.',
      sensations: [
        'Голод становится менее навязчивым по сравнению с первым днем.',
        'Физическая работоспособность обычно ниже привычной.',
        'Может расти субъективная ясность мышления.',
      ],
    },
    recommendations: [
      'Держите спокойный режим активности и избегайте перегрева.',
      'Следите за водно-солевым балансом и самочувствием в динамике.',
      'Планируйте день так, чтобы был доступ к отдыху.',
    ],
    precautions: [
      'При прогрессирующей слабости, головокружении или рвоте прекращайте практику.',
      'Людям с хроническими заболеваниями лучше не продолжать без наблюдения специалиста.',
    ],
  },
  {
    id: 6,
    hoursStart: 36,
    hoursEnd: 48,
    title: 'Ранний устойчивый кетоз',
    subtitle: 'Энергия из жиров и кетонов',
    icon: Leaf,
    color: 'bg-cyan-100 text-cyan-600 dark:bg-cyan-900/30 dark:text-cyan-300',
    details: {
      physiology:
        'Кетоновый метаболизм становится более устойчивым, а колебания аппетита у большинства людей снижаются. При этом физические ресурсы остаются ограниченными, особенно при высокой нагрузке.',
      sensations: [
        'Чувство голода обычно слабее, чем в первые сутки.',
        'Возможна сухость во рту и легкий дискомфорт от ограниченного рациона.',
        'Физическая слабость выражена сильнее, чем ментальная усталость.',
      ],
    },
    recommendations: [
      'Поддерживайте гидратацию и щадящий режим дня.',
      'Ограничьте активность до прогулок и легкой растяжки.',
      'Следите за качеством сна и температурным комфортом.',
    ],
    precautions: [
      'Если симптомы ухудшаются, а не стабилизируются, протокол нужно завершать.',
      'При нарушениях ритма сердца или выраженной слабости нужна очная оценка.',
    ],
  },
  {
    id: 7,
    hoursStart: 48,
    hoursEnd: 72,
    title: 'Стабильная кетозная фаза',
    subtitle: '2-3 сутки',
    icon: Trophy,
    color: 'bg-teal-100 text-teal-600 dark:bg-teal-900/30 dark:text-teal-300',
    details: {
      physiology:
        'Ко вторым-третьим суткам организм обычно достигает более стабильной адаптации к кетоновому пути. Это не означает отсутствие рисков, но субъективные колебания аппетита и энергии часто становятся более предсказуемыми.',
      sensations: [
        'Относительная стабильность аппетита и настроения.',
        'Энергия для интеллектуальных задач может быть сохранена.',
        'Физическая выносливость остается ограниченной.',
      ],
    },
    recommendations: [
      'Оставляйте только низкоинтенсивную активность и восстановление.',
      'Контролируйте сон, уровень стресса и гидратацию.',
      'Планируйте мягкий выход заранее, не в последний момент.',
    ],
    precautions: [
      'Сильная слабость, спутанность сознания или ухудшение координации - повод завершить голодание.',
      'При хронических заболеваниях этот этап желательно проходить под наблюдением.',
    ],
  },
  {
    id: 8,
    hoursStart: 72,
    hoursEnd: 120,
    title: 'Продленное голодание',
    subtitle: 'Усиленный контроль состояния',
    icon: Shield,
    color: 'bg-slate-100 text-slate-600 dark:bg-slate-800/60 dark:text-slate-300',
    details: {
      physiology:
        'После 72 часов организм работает в режиме продленной адаптации. Чем дольше продолжается протокол, тем важнее контроль самочувствия, водно-электролитного баланса и общего функционального состояния.',
      sensations: [
        'Снижение физического ресурса на фоне более экономного метаболизма.',
        'Возможны эпизоды апатии, сонливости или раздражительности.',
        'Чувствительность к стрессу, холоду и недосыпу повышается.',
      ],
    },
    recommendations: [
      'Снизьте нагрузку до минимума и добавьте больше периодов отдыха.',
      'Пейте воду регулярно, контролируйте признаки обезвоживания.',
      'Продумайте пошаговый выход с микропорциями и паузами.',
    ],
    precautions: [
      'Нарастающая слабость, судороги, выраженные сердечные симптомы требуют немедленной остановки.',
      'Продолжение этого этапа без медицинского контроля повышает риск осложнений.',
    ],
  },
  {
    id: 9,
    hoursStart: 120,
    hoursEnd: 168,
    title: 'Высокорисковый продленный этап',
    subtitle: '5-7 сутки и далее',
    icon: Moon,
    color: 'bg-stone-100 text-stone-600 dark:bg-stone-800/60 dark:text-stone-300',
    details: {
      physiology:
        'Эта зона относится к высокому уровню нагрузки на регуляторные системы. Метаболизм работает в выраженно экономном режиме, и любая ошибка в наблюдении или выходе может приводить к тяжелой переносимости.',
      sensations: [
        'Выраженная физическая утомляемость даже при обычной активности.',
        'Нестабильное настроение, проблемы со сном, снижение концентрации.',
        'Повышенная чувствительность к обезвоживанию и стрессу.',
      ],
    },
    recommendations: [
      'Рассматривайте завершение протокола как приоритет, а не продолжение любой ценой.',
      'Переходите к мягкому выходу: небольшие порции, постепенное расширение рациона.',
      'Сохраняйте максимальный щадящий режим до восстановления питания.',
    ],
    precautions: [
      'При любых выраженных симптомах (боль в груди, обморок, спутанность) требуется немедленное прекращение и медицинская помощь.',
      'Длительные протоколы этого уровня безопаснее проводить только под клиническим наблюдением.',
    ],
  },
];
